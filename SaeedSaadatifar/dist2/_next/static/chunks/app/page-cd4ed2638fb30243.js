(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7261:function(e,t,n){Promise.resolve().then(n.bind(n,4692))},4692:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return components_Control}});var l,o=n(7437),s=n(2265),components_Auth=()=>(0,o.jsx)("div",{className:"h-screen w-screen",children:"Auth"});let createStoreImpl=e=>{let t;let n=new Set,setState=(e,l)=>{let o="function"==typeof e?e(t):e;if(!Object.is(o,t)){let e=t;t=(null!=l?l:"object"!=typeof o)?o:Object.assign({},t,o),n.forEach(n=>n(t,e))}},getState=()=>t,l={setState,getState,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}};return t=e(setState,getState,l),l},createStore=e=>e?createStoreImpl(e):createStoreImpl;var c=n(5401);let{useSyncExternalStoreWithSelector:i}=c,d=!1,createImpl=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t="function"==typeof e?createStore(e):e,useBoundStore=(e,n)=>(function(e,t=e.getState,n){n&&!d&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),d=!0);let l=i(e.subscribe,e.getState,e.getServerState||e.getState,t,n);return(0,s.useDebugValue)(l),l})(t,e,n);return Object.assign(useBoundStore,t),useBoundStore},u=(l?createImpl(l):createImpl)(e=>({Contacts:[],AllChats:[],refresh:0,selectedContact:null,setSelectedContact:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e(()=>({selectedContact:t}))},setContacts:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e(()=>({Contacts:t}))},setAllChats:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e(()=>({AllChats:t}))},setRefresh:()=>e(e=>({refresh:e.refresh+1}))}));var Chats=()=>{let{AllChats:e,selectedContact:t}=u(),n=(0,s.useRef)();return(0,s.useEffect)(()=>{n.current&&(n.current.scrollTop=n.current.scrollHeight-n.current.clientHeight)},[e,t]),(0,o.jsx)("div",{ref:n,className:"flex overflow-y-auto grow gap-2 p-2 flex-col ".concat(e.filter(e=>e.receiver==(null==t?void 0:t.username)||e.sender==(null==t?void 0:t.username)).length>0?"":"justify-center items-center"),children:e.filter(e=>e.receiver==(null==t?void 0:t.username)||e.sender==(null==t?void 0:t.username)).length>0?e.filter(e=>e.receiver==(null==t?void 0:t.username)||e.sender==(null==t?void 0:t.username)).map(e=>(0,o.jsxs)("div",{className:"p-2 ".concat(e.receiver==localStorage.username?"self-start":"self-end"," w-64 border break-words border-black rounded-2xl"),children:[(0,o.jsx)("div",{className:"text-lg font-semibold",children:e.text}),(0,o.jsx)("div",{className:"text-end text-xs font-semibold",children:new Date(e.date).toLocaleString("fa-ir")})]},e.id)):"No Message"})},components_DeleteContact=e=>{let{number:t,setIsShowDelete:n}=e,{setSelectedContact:l,setRefresh:s}=u();return(0,o.jsx)("div",{onClick:e=>{n(!1)},className:"absolute h-screen w-screen backdrop-blur-sm flex justify-center items-center",children:(0,o.jsxs)("div",{onClick:e=>e.stopPropagation(),className:"flex shadow-black shadow-2xl drop-shadow-2xl px-14 relative gap-7 flex-col p-10 items-center bg-slate-600 rounded-2xl",children:[(0,o.jsx)("div",{onClick:e=>{n(!1)},className:"absolute hover:bg-slate-300 cursor-pointer top-3 left-3 border border-black p-2 rounded-full",children:"X"}),(0,o.jsx)("p",{className:"text-2xl font-bold",children:"Delete Contact"}),(0,o.jsx)("p",{className:"text-sm font-semibold",children:"Are You Want Delete This Contact?"}),(0,o.jsx)("button",{onClick:()=>{let e=JSON.stringify({username:t});fetch("https://farawin.iran.liara.run/api/contact",{headers:{authorization:"".concat(localStorage.token)},body:e,method:"DELETE"}).then(e=>e.json().then(e=>{alert(e.message),"200"==e.code&&(n(!1),l(null),s())}))},className:"w-full rounded-2xl py-2 hover:bg-slate-300 cursor-pointer border border-black",children:"Delete"})]})})},components_EditPage=e=>{let{nam:t,number:n,setIsShowEdit:l}=e,[c,i]=(0,s.useState)(t),{setRefresh:d}=u();return(0,o.jsx)("div",{onClick:e=>{l(!1)},className:"absolute h-screen w-screen backdrop-blur-sm flex justify-center items-center",children:(0,o.jsxs)("div",{onClick:e=>e.stopPropagation(),className:"flex shadow-black shadow-2xl drop-shadow-2xl px-14 relative gap-7 flex-col p-10 items-center bg-slate-600 rounded-2xl",children:[(0,o.jsx)("div",{onClick:e=>{l(!1)},className:"absolute hover:bg-slate-300 cursor-pointer top-3 left-3 border border-black p-2 rounded-full",children:"X"}),(0,o.jsx)("p",{className:"text-2xl font-bold",children:"Edit Contact"}),(0,o.jsxs)("div",{className:"flex flex-col relative",children:[(0,o.jsx)("label",{className:"absolute font-semibold bg-slate-600 top-[-13px] left-3 px-1",htmlFor:"name",children:"Name :"}),(0,o.jsx)("input",{value:c,onInput:e=>i(e.target.value),id:"name",className:"bg-slate-600 text-white text-xs placeholder:text-xs placeholder:text-slate-200 placeholder:opacity-60 border border-black p-3 rounded-xl focus:outline-none"})]}),(0,o.jsxs)("div",{className:"flex flex-col relative",children:[(0,o.jsx)("label",{className:"absolute font-semibold bg-slate-600 top-[-13px] left-3 px-1",htmlFor:"number",children:"Number :"}),(0,o.jsx)("input",{disabled:!0,value:n,id:"number",className:"bg-slate-600 text-white text-xs placeholder:text-xs placeholder:text-slate-200 placeholder:opacity-60 border border-black p-3 rounded-xl focus:outline-none"})]}),(0,o.jsx)("button",{onClick:()=>{fetch("https://farawin.iran.liara.run/api/contact",{headers:{authorization:"".concat(localStorage.token)},body:'{\n "username":"'.concat(n,'",\n "name":"').concat(c,'"\n}'),method:"PUT"}).then(e=>e.json().then(e=>{alert(e.message),"200"==e.code&&(l(!1),d())}))},className:"w-full rounded-2xl mt-7 py-2 hover:bg-slate-300 cursor-pointer border border-black",children:"Edit"})]})})},components_ChatPage=()=>{let{setRefresh:e,selectedContact:t,setSelectedContact:n}=u(),[l,c]=(0,s.useState)(!1),[i,d]=(0,s.useState)(!1),[x,h]=(0,s.useState)(""),f=(0,s.useRef)();return(0,o.jsxs)(o.Fragment,{children:[l&&(0,o.jsx)(components_EditPage,{number:null==t?void 0:t.username,setIsShowEdit:c,nam:null==t?void 0:t.name}),i&&(0,o.jsx)(components_DeleteContact,{number:null==t?void 0:t.username,setIsShowDelete:d}),(0,o.jsxs)("div",{className:"grow p-3 bg-blue-300 flex flex-col",children:[(0,o.jsxs)("div",{className:"bg-green-500 gap-3 rounded-xl flex p-3",children:[(0,o.jsx)("div",{onClick:e=>{n(null)},className:"p-3 cursor-pointer hover:bg-slate-300 rounded-xl border border-black",children:"Back"}),(0,o.jsxs)("div",{className:"flex gap-3 grow",children:[(0,o.jsx)("div",{className:"flex grow items-center text-xl font-semibold",children:null==t?void 0:t.name}),(0,o.jsx)("div",{onClick:()=>{c(!0)},className:"p-2 cursor-pointer hover:bg-slate-300  px-4 flex items-center text-xs rounded-xl border border-black",children:"Edit"}),(0,o.jsx)("div",{onClick:()=>d(!0),className:"p-2 cursor-pointer hover:bg-slate-300 flex items-center text-xs rounded-xl border border-black",children:"Delete"}),(0,o.jsx)("div",{onClick:()=>e(),className:"p-2 cursor-pointer hover:bg-slate-300 flex items-center text-xs rounded-xl border border-black",children:"Refresh"})]})]}),(0,o.jsx)(Chats,{}),(0,o.jsxs)("div",{className:"bg-green-500 gap-3 rounded-xl flex p-3",children:[(0,o.jsx)("input",{onInput:e=>h(e.target.value),ref:f,placeholder:"Message",className:"grow p-1 text-white placeholder:opacity-50 placeholder:text-white bg-green-500 focus:outline-none"}),(0,o.jsx)("div",{onClick:()=>{let n=JSON.stringify({contactUsername:null==t?void 0:t.username,textHtml:x});fetch("https://farawin.iran.liara.run/api/chat",{headers:{authorization:"".concat(localStorage.token)},body:n,method:"POST"}).then(t=>t.json().then(t=>{"200"==t.code&&(f.current.value="",e())}))},className:"p-2 cursor-pointer hover:bg-slate-300  px-4 flex items-center text-xs rounded-xl border border-black",children:"Send"})]})]})]})},components_Contacts=()=>{let{Contacts:e,setSelectedContact:t,selectedContact:n}=u();return(0,o.jsx)("div",{className:"flex p-1 flex-col overflow-y-auto grow",children:e.map(e=>(0,o.jsxs)("div",{onClick:n=>{t(e),n.stopPropagation()},className:"py-2 ".concat((null==n?void 0:n.username)==e.username&&"bg-slate-500"," px-5 flex gap-3 hover:bg-slate-400 rounded-xl cursor-pointer"),children:[(0,o.jsx)("div",{className:"h-10 w-10 border my-auto border-black rounded-full"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"text-lg font-bold",children:e.name}),(0,o.jsx)("div",{className:"text-xs",children:e.username})]})]},e.ref+e.username))})},components_AddContact=e=>{let{setIsShowAdd:t}=e,[n,l]=(0,s.useState)(""),{setRefresh:c}=u(),[i,d]=(0,s.useState)("");return(0,o.jsx)("div",{onClick:e=>{t(!1)},className:"absolute h-screen w-screen backdrop-blur-sm flex justify-center items-center",children:(0,o.jsxs)("div",{onClick:e=>e.stopPropagation(),className:"flex shadow-black shadow-2xl drop-shadow-2xl px-14 relative gap-7 flex-col p-10 items-center bg-slate-600 rounded-2xl",children:[(0,o.jsx)("div",{onClick:e=>{t(!1)},className:"absolute hover:bg-slate-300 cursor-pointer top-3 left-3 border border-black p-2 rounded-full",children:"X"}),(0,o.jsx)("p",{className:"text-2xl font-bold",children:"Add Contact"}),(0,o.jsxs)("div",{className:"flex flex-col relative",children:[(0,o.jsx)("label",{className:"absolute font-semibold bg-slate-600 top-[-13px] left-3 px-1",htmlFor:"name",children:"Name :"}),(0,o.jsx)("input",{onInput:e=>l(e.target.value),id:"name",placeholder:"Saeed",className:"bg-slate-600 text-white text-xs placeholder:text-xs placeholder:text-slate-200 placeholder:opacity-60 border border-black p-3 rounded-xl focus:outline-none"})]}),(0,o.jsxs)("div",{className:"flex flex-col relative",children:[(0,o.jsx)("label",{className:"absolute font-semibold bg-slate-600 top-[-13px] left-3 px-1",htmlFor:"number",children:"Number :"}),(0,o.jsx)("input",{onInput:e=>d(e.target.value),maxLength:11,id:"number",placeholder:"09000000000",className:"bg-slate-600 text-white text-xs placeholder:text-xs placeholder:text-slate-200 placeholder:opacity-60 border border-black p-3 rounded-xl focus:outline-none"})]}),(0,o.jsx)("button",{onClick:()=>{fetch("https://farawin.iran.liara.run/api/contact",{headers:{authorization:"".concat(localStorage.token)},body:'{\n "username":"'.concat(i,'",\n "name":"').concat(n,'"\n}'),method:"POST"}).then(e=>e.json().then(e=>{alert(e.message),"200"==e.code&&(t(!1),c())}))},className:"w-full rounded-2xl mt-7 py-2 hover:bg-slate-300 cursor-pointer border border-black",children:"Add"})]})})},components_Sidebar=()=>{let{setRefresh:e}=u(),[t,n]=(0,s.useState)(!1);return(0,o.jsxs)(o.Fragment,{children:[t&&(0,o.jsx)(components_AddContact,{setIsShowAdd:n}),(0,o.jsxs)("div",{className:"w-1/3 p-3 bg-red-400 h-screen flex flex-col",children:[(0,o.jsxs)("div",{className:" flex border-b pb-3 w-full",children:[(0,o.jsx)("div",{className:"text-2xl grow my-auto font-bold ",children:"Farawin"}),(0,o.jsxs)("div",{className:"flex gap-3",children:[(0,o.jsx)("div",{onClick:()=>e(),className:"p-2 border border-black rounded-xl hover:bg-slate-300 cursor-pointer",children:"Ref"}),(0,o.jsx)("div",{onClick:()=>n(!0),className:"p-2 border border-black rounded-xl hover:bg-slate-300 cursor-pointer",children:"Add"})]})]}),(0,o.jsx)(components_Contacts,{})]})]})},components_Home=()=>{let{refresh:e,selectedContact:t,setContacts:n,setAllChats:l}=u();return(0,s.useEffect)(()=>{fetch("https://farawin.iran.liara.run/api/contact",{headers:{authorization:"".concat(localStorage.token)}}).then(e=>e.json().then(e=>n(e.contactList.filter(e=>e.ref==localStorage.username)))),fetch("https://farawin.iran.liara.run/api/chat",{headers:{authorization:"".concat(localStorage.token)},method:"GET"}).then(e=>e.json().then(e=>{"200"==e.code&&l(e.chatList.filter(e=>e.receiver==localStorage.username||e.sender==localStorage.username).sort((e,t)=>+new Date(e.date)-+new Date(t.date)))}))},[e]),(0,o.jsx)("div",{className:"h-screen w-screen",children:(0,o.jsxs)("div",{className:"flex w-full h-full",children:[(0,o.jsx)(components_Sidebar,{}),t&&(0,o.jsx)(components_ChatPage,{})]})})},components_Control=()=>{let[e,t]=(0,s.useState)();return(0,s.useEffect)(()=>{localStorage.token?t(!0):t(!1)},[]),(0,o.jsx)(o.Fragment,{children:e?(0,o.jsx)(components_Home,{}):(0,o.jsx)(components_Auth,{})})}},622:function(e,t,n){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l=n(2265),o=Symbol.for("react.element"),s=Symbol.for("react.fragment"),c=Object.prototype.hasOwnProperty,i=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,n){var l,s={},u=null,x=null;for(l in void 0!==n&&(u=""+n),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(x=t.ref),t)c.call(t,l)&&!d.hasOwnProperty(l)&&(s[l]=t[l]);if(e&&e.defaultProps)for(l in t=e.defaultProps)void 0===s[l]&&(s[l]=t[l]);return{$$typeof:o,type:e,key:u,ref:x,props:s,_owner:i.current}}t.Fragment=s,t.jsx=q,t.jsxs=q},7437:function(e,t,n){"use strict";e.exports=n(622)},1853:function(e,t,n){"use strict";/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l=n(2265),o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=l.useState,c=l.useEffect,i=l.useLayoutEffect,d=l.useDebugValue;function r(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!o(e,n)}catch(e){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),l=s({inst:{value:n,getSnapshot:t}}),o=l[0].inst,u=l[1];return i(function(){o.value=n,o.getSnapshot=t,r(o)&&u({inst:o})},[e,n,t]),c(function(){return r(o)&&u({inst:o}),e(function(){r(o)&&u({inst:o})})},[e]),d(n),n};t.useSyncExternalStore=void 0!==l.useSyncExternalStore?l.useSyncExternalStore:u},8704:function(e,t,n){"use strict";/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l=n(2265),o=n(6272),s="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},c=o.useSyncExternalStore,i=l.useRef,d=l.useEffect,u=l.useMemo,x=l.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,l,o){var h=i(null);if(null===h.current){var f={hasValue:!1,value:null};h.current=f}else f=h.current;var p=c(e,(h=u(function(){function a(t){if(!i){if(i=!0,e=t,t=l(t),void 0!==o&&f.hasValue){var n=f.value;if(o(n,t))return c=n}return c=t}if(n=c,s(e,t))return n;var d=l(t);return void 0!==o&&o(n,d)?n:(e=t,c=d)}var e,c,i=!1,d=void 0===n?null:n;return[function(){return a(t())},null===d?void 0:function(){return a(d())}]},[t,n,l,o]))[0],h[1]);return d(function(){f.hasValue=!0,f.value=p},[p]),x(p),p}},6272:function(e,t,n){"use strict";e.exports=n(1853)},5401:function(e,t,n){"use strict";e.exports=n(8704)}},function(e){e.O(0,[971,472,744],function(){return e(e.s=7261)}),_N_E=e.O()}]);